// https://d3js.org/d3-zoom/ Version 1.7.1. Copyright 2017 Mike Bostock.
!function(t,n){ "object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3-dispatch"),require("d3-drag"),require("d3-interpolate"),require("d3-selection"),require("d3-transition")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],n):n(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3,t.d3)}(this,function(t,n,e,o,i,r){"use strict";function u(t,n,e){this.k=t,this.x=n,this.y=e}function h(t){return t.__zoom||v}function s(){i.event.stopImmediatePropagation()}function c(){return!i.event.button}function a(){var t,n,e=this;return e instanceof SVGElement?(t=(e=e.ownerSVGElement||e).width.baseVal.value,n=e.height.baseVal.value):(t=e.clientWidth,n=e.clientHeight),[[0,0],[t,n]]}function f(){return this.__zoom||v}function l(){return-i.event.deltaY*(i.event.deltaMode?120:1)/500}function m(){return"ontouchstart"in this}function p(t,n,e){var o=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],r=t.invertY(n[0][1])-e[0][1],u=t.invertY(n[1][1])-e[1][1];return t.translate(i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i),u>r?(r+u)/2:Math.min(0,r)||Math.max(0,u))}var d=function(t){return function(){return t}};u.prototype={constructor:u,scale:function(t){return 1===t?this:new u(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new u(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var v=new u(1,0,0);h.prototype=u.prototype;var y=function(){i.event.preventDefault(),i.event.stopImmediatePropagation()};t.zoom=function(){function t(t){t.property("__zoom",f).on("wheel.zoom",w).on("mousedown.zoom",M).on("dblclick.zoom",T).filter(S).on("touchstart.zoom",b).on("touchmove.zoom",Y).on("touchend.zoom touchcancel.zoom",X).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(t,n){return(n=Math.max(j[0],Math.min(j[1],n)))===t.k?t:new u(n,t.x,t.y)}function z(t,n,e){var o=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return o===t.x&&i===t.y?t:new u(t.k,o,i)}function _(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function g(t,n,e){t.on("start.zoom",function(){k(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).end()}).tween("zoom",function(){var t=arguments,o=k(this,t),i=V.apply(this,t),r=e||_(i),h=Math.max(i[1][0]-i[0][0],i[1][1]-i[0][1]),s=this.__zoom,c="function"==typeof n?n.apply(this,t):n,a=H(s.invert(r).concat(h/s.k),c.invert(r).concat(h/c.k));return function(t){if(1===t)t=c;else{var n=a(t),e=h/n[2];t=new u(e,r[0]-n[0]*e,r[1]-n[1]*e)}o.zoom(null,t)}})}function k(t,n){for(var e,o=0,i=K.length;o<i;++o)if((e=K[o]).that===t)return e;return new x(t,n)}function x(t,n){this.that=t,this.args=n,this.index=-1,this.active=0,this.extent=V.apply(t,n)}function w(){if(D.apply(this,arguments)){var t=k(this,arguments),n=this.__zoom,e=Math.max(j[0],Math.min(j[1],n.k*Math.pow(2,P.apply(this,arguments)))),o=i.mouse(this);if(t.wheel)t.mouse[0][0]===o[0]&&t.mouse[0][1]===o[1]||(t.mouse[1]=n.invert(t.mouse[0]=o)),clearTimeout(t.wheel);else{if(n.k===e)return;t.mouse=[o,n.invert(o)],r.interrupt(this),t.start()}y(),t.wheel=setTimeout(function(){t.wheel=null,t.end()},Z),t.zoom("mouse",I(z(h(n,e),t.mouse[0],t.mouse[1]),t.extent,B))}}function M(){if(!E&&D.apply(this,arguments)){var t=k(this,arguments),n=i.select(i.event.view).on("mousemove.zoom",function(){if(y(),!t.moved){var n=i.event.clientX-u,e=i.event.clientY-h;t.moved=n*n+e*e>A}t.zoom("mouse",I(z(t.that.__zoom,t.mouse[0]=i.mouse(t.that),t.mouse[1]),t.extent,B))},!0).on("mouseup.zoom",function(){n.on("mousemove.zoom mouseup.zoom",null),e.dragEnable(i.event.view,t.moved),y(),t.end()},!0),o=i.mouse(this),u=i.event.clientX,h=i.event.clientY;e.dragDisable(i.event.view),s(),t.mouse=[o,this.__zoom.invert(o)],r.interrupt(this),t.start()}}function T(){if(D.apply(this,arguments)){var n=this.__zoom,e=i.mouse(this),o=n.invert(e),r=n.k*(i.event.shiftKey?.5:2),u=I(z(h(n,r),e,o),V.apply(this,arguments),B);y(),G>0?i.select(this).transition().duration(G).call(g,u,e):i.select(this).call(t.transform,u)}}function b(){if(D.apply(this,arguments)){var t,n,e,o,u=k(this,arguments),h=i.event.changedTouches,c=h.length;for(s(),n=0;n<c;++n)e=h[n],o=[o=touch(this,h,e.identifier),this.__zoom.invert(o),e.identifier],u.touch0?u.touch1||(u.touch1=o):(u.touch0=o,t=!0);if(q&&(q=clearTimeout(q),!u.touch1))return u.end(),void((o=i.select(this).on("dblclick.zoom"))&&o.apply(this,arguments));t&&(q=setTimeout(function(){q=null},W),r.interrupt(this),u.start())}}function Y(){if(D.apply(this,arguments)){var t,n,e,o,r=k(this,arguments),u=i.event.changedTouches,s=u.length;for(y(),q&&(q=clearTimeout(q)),t=0;t<s;++t)n=u[t],e=touch(this,u,n.identifier),r.touch0&&r.touch0[2]===n.identifier?r.touch0[0]=e:r.touch1&&r.touch1[2]===n.identifier&&(r.touch1[0]=e);if(n=r.that.__zoom,r.touch1){var c=r.touch0[0],a=r.touch0[1],f=r.touch1[0],l=r.touch1[1],m=(m=f[0]-c[0])*m+(m=f[1]-c[1])*m,p=(p=l[0]-a[0])*p+(p=l[1]-a[1])*p;n=h(n,Math.sqrt(m/p)),e=[(c[0]+f[0])/2,(c[1]+f[1])/2],o=[(a[0]+l[0])/2,(a[1]+l[1])/2]}else{if(!r.touch0)return;e=r.touch0[0],o=r.touch0[1]}r.zoom("touch",I(z(n,e,o),r.extent,B))}}function X(){var t,n,e=k(this,arguments),o=i.event.changedTouches,r=o.length;for(s(),E&&clearTimeout(E),E=setTimeout(function(){E=null},W),t=0;t<r;++t)n=o[t],e.touch0&&e.touch0[2]===n.identifier?delete e.touch0:e.touch1&&e.touch1[2]===n.identifier&&delete e.touch1;e.touch1&&!e.touch0&&(e.touch0=e.touch1,delete e.touch1),e.touch0?e.touch0[1]=this.__zoom.invert(e.touch0[0]):e.end()}var q,E,D=c,V=a,I=p,P=l,S=m,j=[0,1/0],B=[[-1/0,-1/0],[1/0,1/0]],G=250,H=o.interpolateZoom,K=[],O=n.dispatch("start","zoom","end"),W=500,Z=150,A=0;return t.transform=function(t,n){var e=t.selection?t.selection():t;e.property("__zoom",f),t!==e?g(t,n):e.interrupt().each(function(){k(this,arguments).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()})},t.scaleBy=function(n,e){t.scaleTo(n,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)})},t.scaleTo=function(n,e){t.transform(n,function(){var t=V.apply(this,arguments),n=this.__zoom,o=_(t),i=n.invert(o),r="function"==typeof e?e.apply(this,arguments):e;return I(z(h(n,r),o,i),t,B)})},t.translateBy=function(n,e,o){t.transform(n,function(){return I(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof o?o.apply(this,arguments):o),V.apply(this,arguments),B)})},t.translateTo=function(n,e,o){t.transform(n,function(){var t=V.apply(this,arguments),n=this.__zoom,i=_(t);return I(v.translate(i[0],i[1]).scale(n.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof o?-o.apply(this,arguments):-o),t,B)})},x.prototype={start:function(){return 1==++this.active&&(this.index=K.push(this)-1,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(K.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(n){i.customEvent(new function(t,n,e){this.target=t,this.type=n,this.transform=e}(t,n,this.that.__zoom),O.apply,O,[n,this.that,this.args])}},t.wheelDelta=function(n){return arguments.length?(P="function"==typeof n?n:d(+n),t):P},t.filter=function(n){return arguments.length?(D="function"==typeof n?n:d(!!n),t):D},t.touchable=function(n){return arguments.length?(S="function"==typeof n?n:d(!!n),t):S},t.extent=function(n){return arguments.length?(V="function"==typeof n?n:d([[+n[0][0],+n[0][1]],[+n[1][0],+n[1][1]]]),t):V},t.scaleExtent=function(n){return arguments.length?(j[0]=+n[0],j[1]=+n[1],t):[j[0],j[1]]},t.translateExtent=function(n){return arguments.length?(B[0][0]=+n[0][0],B[1][0]=+n[1][0],B[0][1]=+n[0][1],B[1][1]=+n[1][1],t):[[B[0][0],B[0][1]],[B[1][0],B[1][1]]]},t.constrain=function(n){return arguments.length?(I=n,t):I},t.duration=function(n){return arguments.length?(G=+n,t):G},t.interpolate=function(n){return arguments.length?(H=n,t):H},t.on=function(){var n=O.on.apply(O,arguments);return n===O?t:n},t.clickDistance=function(n){return arguments.length?(A=(n=+n)*n,t):Math.sqrt(A)},t},t.zoomTransform=h,t.zoomIdentity=v,Object.defineProperty(t,"__esModule",{value:!0})});